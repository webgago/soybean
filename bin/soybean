#!/usr/bin/env ruby
$:.unshift File.absolute_path('vendor')
$:.unshift File.absolute_path('vendor/soap4r')
$:.unshift File.absolute_path('lib')
require 'thor'
require 'thor/actions'
require 'soybean'


class Soybean::CLI < Thor
  include Thor::Actions

  desc "types file_path.xsd", "Generate Ruby classes for xsd-schema from file_path.xsd"
  method_options :quiet => :boolean, :force => :boolean
  def types(location, destination = '.')
    Soybean::Generators::TypesGenerator.new(URI.parse(location)).generate do |filename, content|
      create_file File.join(destination, filename), content, options
    end
  end

  desc "service [PATH_TO_WSDL] [DESTINATION_DIR]", "Generate Ruby classes from WSDL"
  method_options :quiet => :boolean, :force => :boolean
  def service(wsdl, destination_dir)
    Soybean::Generators::ServiceGenerator.new(destination_dir, wsdl).generate do |filename, content|
      create_file filename, content, options
    end
  end
end

Soybean::CLI.start